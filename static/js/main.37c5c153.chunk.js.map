{"version":3,"sources":["algorithms/utils.ts","algorithms/compression.ts","visualization.tsx","compressors.tsx","Compare.tsx","algorithms/tikz.ts","visualizations/drawing.tsx","visualizations/Lz77Visualization.tsx","visualizations/RlzVisualization.tsx","visualizations/RelzVisualization.tsx","visualizations/RelzRecVisualization.tsx","Slides.tsx","hooks.ts","visualizations/common.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["indexOfSubArray","array","subarray","outer","i","length","h","lastIndexOfSubArray","stringToCodePoints","input","result","codePoint","codePointAt","push","compressLz77","compressWithSlidingWindow","compressRlz","pos","phraseLength","lastOccurrence","currentPhrase","slice","currentOccurrence","type","symbol","l","p","windowSize","windowStart","Math","max","min","reference","rlz","compressRlzPrefix","prefixLength","prefixPhrases","suffixPhrases","phrase","relzMapping","symbolToPhraseMapping","Map","contentToSymbolMapping","mappedInput","getMapping","currentContent","content","isEqual","newMetaSymbol","size","set","extractLzLikeParsing","phrases","mapping","positionOffset","sum","map","mappedPhrase","get","undefined","Error","mappedPos","sumBy","c","mappedLength","compressRelz","firstPassPhrases","metaSymbols","metaSymbolPhrases","compressRelzRecursive","recursionLimit","passes","metaSymbolsPhrases","suffixPhrasesCompressed","suffixMetaSymbols","suffixMetaSymbolsPhrases","Character","props","style","display","width","height","border","textAlign","verticalAlign","lineHeight","character","VisualizePhrases","initialCompressorSettings","availableCompressors","lz77","title","needsReference","needsPrefixSize","needsWindowSize","needsRecursionLimit","relz","CompressorSettingEditor","update","settings","onChange","current","Card","Header","Body","Row","Col","value","e","parseInt","target","CompressorOutput","codePoints","phrasesToString","String","fromCodePoint","join","isNaN","referenceCodePoints","rlzPhrasesToString","Compare","useState","setInput","output","done","tikzRenderLz77","compressorType","setCompressorType","compressorSettings","setCompressorSettings","Container","lg","Dropdown","as","ButtonGroup","Button","onClick","Toggle","split","Menu","Item","idx","className","v","TARGET_COLOR","SOURCE_COLOR","SharedDefinitions","id","markerWidth","markerHeight","refX","refY","orient","points","gradientTransform","offset","stopColor","Arrow","x1","x2","y","d","stroke","fill","Arrow2","y1","y2","straight","v1","v2","markerEnd","x","text","color","w","overflowY","userSelect","CurlyBrace","q","dx","dy","len","sqrt","qx1","qy1","qx2","qy2","tx1","ty1","qx3","qy3","qx4","qy4","path","PhraseDisplay","transform","abs","ShortPhrase","CopyingPhrase","Lz77Visualization","arrowStart","arrowTarget","data","colors","Array","phrasePos","take","shortPhrases","copyingPhrases","currentPos","forEach","char","RlzVisualization","referenceColors","RelzVisualization","finalStep","stepsCount","mappingArrows","metaArrowStart","metaArrowTarget","s","metaColors","currentMetaPhrase","backMappingArrows","currentMetaPos","zip","metaP","RelzRecVisualization","lineDistance","step","steps","console","log","passOffsets","reduce","lengths","pass","last","passesVisible","phrasesVisible","mappingsVisible","symbols","phraseDisplays","pi","JSON","stringify","Slides","currentStep","setCurrentStep","selectedCompressor","setSelectedCompressor","currentCompressor","referenceString","setReferenceString","setWindowSize","prefixSize","setPrefixSize","setRecursionLimit","query","location","useLocation","URLSearchParams","search","useQuery","useEffect","keys","includes","lastPass","flatMap","reverse","computeData","pathname","currentQuery","url","window","origin","toString","Form","Group","Label","Control","values","Check","label","name","checked","placeholder","md","disabled","InputGroup","FormControl","readOnly","Append","variant","App","Navbar","bg","Brand","href","Nav","Link","to","exact","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.37c5c153.chunk.js","sourcesContent":["export function indexOfSubArray<T>(array: T[], subarray: T[]): number {\n  outer: for (let i = 0; i <= array.length - subarray.length; i++) {\n    for (let h = 0; h < subarray.length; h++) {\n      if (array[i + h] !== subarray[h]) {\n        continue outer;\n      }\n    }\n    return i;\n  }\n\n  return -1;\n}\n\nexport function lastIndexOfSubArray<T>(array: T[], subarray: T[]): number {\n  outer: for (let i = array.length - subarray.length; i >= 0; i--) {\n    for (let h = 0; h < subarray.length; h++) {\n      if (array[i + h] !== subarray[h]) {\n        continue outer;\n      }\n    }\n    return i;\n  }\n\n  return -1;\n}\n\nexport function stringToCodePoints(input: string): number[] {\n  const result = [];\n\n  for (var i = 0; i < input.length; i++) {\n    var codePoint = input.codePointAt(i);\n\n    if (!codePoint) {\n      break;\n    }\n\n    result.push(codePoint);\n  }\n\n  return result;\n}\n\nexport function codePointsToString(...codePoints: number[]): string {\n  return String.fromCodePoint(...codePoints);\n}\n","import { indexOfSubArray, lastIndexOfSubArray } from \"./utils\";\nimport { isEqual, sum, sumBy } from \"lodash\";\n\nexport type Phrase =\n  | {\n      type: \"literal\";\n      symbol: number;\n      pos: number;\n      l: 1;\n    }\n  | {\n      type: \"copy\";\n      pos: number;\n      p: number;\n      l: number;\n    };\n\nexport type RlzPhrase = { rlz: true } & (\n  | {\n      type: \"literal\";\n      symbol: number;\n      l: 1;\n    }\n  | {\n      type: \"copy\";\n      p: number;\n      l: number;\n    }\n);\n\nexport function* compressLz77(input: number[]): Generator<Phrase> {\n  let pos = 0;\n  while (pos < input.length) {\n    let phraseLength = 0;\n    let lastOccurrence = 0;\n    while (pos + phraseLength < input.length) {\n      let currentPhrase = input.slice(pos, pos + phraseLength + 1);\n      let currentOccurrence = lastIndexOfSubArray(\n        input.slice(0, pos + phraseLength),\n        currentPhrase\n      );\n      if (currentOccurrence !== -1) {\n        phraseLength++;\n        lastOccurrence = currentOccurrence;\n      } else {\n        break;\n      }\n    }\n\n    if (phraseLength === 0) {\n      yield { type: \"literal\", pos, symbol: input[pos], l: 1 };\n      pos += 1;\n    } else {\n      yield { type: \"copy\", pos, p: lastOccurrence, l: phraseLength };\n      pos += phraseLength;\n    }\n  }\n}\n\nexport function* compressWithSlidingWindow(\n  input: number[],\n  windowSize: number\n): Generator<Phrase> {\n  let pos = 0;\n  while (pos < input.length) {\n    let phraseLength = 0;\n    let lastOccurrence = 0;\n    while (pos + phraseLength < input.length) {\n      let currentPhrase = input.slice(pos, pos + phraseLength + 1);\n      const windowStart = Math.max(0, pos - windowSize);\n      let currentOccurrence = lastIndexOfSubArray(\n        input.slice(\n          windowStart,\n          Math.min(windowStart + windowSize, pos + phraseLength)\n        ),\n        currentPhrase\n      );\n      if (currentOccurrence !== -1) {\n        phraseLength++;\n        lastOccurrence = currentOccurrence + windowStart;\n      } else {\n        break;\n      }\n    }\n\n    if (phraseLength === 0) {\n      yield { type: \"literal\", pos, symbol: input[pos], l: 1 };\n      pos += 1;\n    } else {\n      yield { type: \"copy\", pos, p: lastOccurrence, l: phraseLength };\n      pos += phraseLength;\n    }\n  }\n}\n\nexport function decompress(phrases: Phrase[]): number[] {\n  let output: number[] = [];\n  for (const phrase of phrases) {\n    if (phrase.type === \"literal\") {\n      output.push(phrase.symbol);\n    } else {\n      for (let i = 0; i < phrase.l; i++) {\n        output.push(output[phrase.p + i]);\n      }\n    }\n  }\n\n  return output;\n}\n\nexport function* compressRlz(\n  input: number[],\n  reference: number[]\n): Generator<RlzPhrase> {\n  let pos = 0;\n  while (pos < input.length) {\n    let phraseLength = 0;\n    let lastOccurrence = 0;\n    while (pos + phraseLength < input.length) {\n      let currentPhrase = input.slice(pos, pos + phraseLength + 1);\n      let currentOccurrence = indexOfSubArray(reference, currentPhrase);\n      if (currentOccurrence !== -1) {\n        phraseLength++;\n        lastOccurrence = currentOccurrence;\n      } else {\n        break;\n      }\n    }\n\n    if (phraseLength === 0) {\n      yield { rlz: true, type: \"literal\", symbol: input[pos], l: 1 };\n      pos += 1;\n    } else {\n      yield { rlz: true, type: \"copy\", p: lastOccurrence, l: phraseLength };\n      pos += phraseLength;\n    }\n  }\n}\n\nexport function decompressRlz(\n  phrases: RlzPhrase[],\n  reference: number[]\n): number[] {\n  let output: number[] = [];\n  for (const phrase of phrases) {\n    if (phrase.type === \"literal\") {\n      output.push(phrase.symbol);\n    } else {\n      for (let i = 0; i < phrase.l; i++) {\n        output.push(reference[phrase.p + i]);\n      }\n    }\n  }\n\n  return output;\n}\n\nexport function compressRlzPrefix(\n  input: number[],\n  prefixLength: number\n): [Phrase[], Phrase[]] {\n  const prefixPhrases: Phrase[] = [];\n  const suffixPhrases: Phrase[] = [];\n  let pos = 0;\n  while (pos < input.length) {\n    let phraseLength = 0;\n    let lastOccurrence = 0;\n    while (pos + phraseLength < input.length) {\n      let currentPhrase = input.slice(pos, pos + phraseLength + 1);\n      let currentOccurrence = lastIndexOfSubArray(\n        input.slice(0, Math.min(pos + phraseLength, prefixLength)),\n        currentPhrase\n      );\n      if (\n        currentOccurrence !== -1 &&\n        (pos >= prefixLength || pos + phraseLength < prefixLength)\n      ) {\n        phraseLength++;\n        lastOccurrence = currentOccurrence;\n      } else {\n        break;\n      }\n    }\n\n    if (phraseLength === 0) {\n      const phrase: Phrase = { type: \"literal\", pos, symbol: input[pos], l: 1 };\n      if (pos < prefixLength) {\n        prefixPhrases.push(phrase);\n      } else {\n        suffixPhrases.push(phrase);\n      }\n      pos += 1;\n    } else {\n      const phrase: Phrase = {\n        type: \"copy\",\n        pos,\n        p: lastOccurrence,\n        l: phraseLength,\n      };\n      if (pos < prefixLength) {\n        prefixPhrases.push(phrase);\n      } else {\n        suffixPhrases.push(phrase);\n      }\n      pos += phraseLength;\n    }\n  }\n\n  return [prefixPhrases, suffixPhrases];\n}\n\nexport function relzMapping(\n  input: Phrase[],\n  reference: number[]\n): [Map<number, Phrase>, number[]] {\n  const symbolToPhraseMapping: Map<number, Phrase> = new Map();\n  const contentToSymbolMapping: [number[], number][] = [];\n  const mappedInput: number[] = [];\n\n  function getMapping(phrase: Phrase): number {\n    const currentContent =\n      phrase.type === \"literal\"\n        ? [phrase.symbol]\n        : reference.slice(phrase.p, phrase.p + phrase.l);\n    for (const [content, symbol] of contentToSymbolMapping) {\n      if (isEqual(content, currentContent)) {\n        return symbol;\n      }\n    }\n\n    const newMetaSymbol = symbolToPhraseMapping.size;\n    symbolToPhraseMapping.set(newMetaSymbol, phrase);\n    contentToSymbolMapping.push([currentContent, newMetaSymbol]);\n    return newMetaSymbol;\n  }\n\n  for (const phrase of input) {\n    mappedInput.push(getMapping(phrase));\n  }\n\n  return [symbolToPhraseMapping, mappedInput];\n}\n\nfunction extractLzLikeParsing(\n  phrases: Phrase[],\n  mapping: Map<number, Phrase>,\n  input: number[],\n  positionOffset: number\n): Phrase[] {\n  const result: Phrase[] = [];\n\n  for (let i = 0; i < phrases.length; i++) {\n    const pos = sum(result.map((p) => p.l)) + positionOffset;\n    const phrase = phrases[i];\n    if (phrase.type === \"literal\") {\n      const mappedPhrase = mapping.get(phrase.symbol);\n      if (mappedPhrase === undefined) {\n        throw new Error(\"no mapping for symbol \" + phrase.symbol);\n      }\n      result.push({\n        ...mappedPhrase,\n        pos,\n      });\n    } else {\n      const mappedPos =\n        sumBy(\n          input.slice(0, phrase.p).map((c) => mapping.get(c)),\n          (p) => p!.l\n        ) + positionOffset;\n      const mappedLength = sumBy(\n        input.slice(phrase.p, phrase.p + phrase.l).map((c) => mapping.get(c)),\n        (p) => p!.l\n      );\n\n      result.push({ type: \"copy\", pos, p: mappedPos, l: mappedLength });\n    }\n  }\n\n  return result;\n}\n\ninterface RelzResult {\n  firstPassPhrases: Phrase[];\n  metaSymbols: number[];\n  metaSymbolPhrases: Phrase[];\n  phrases: Phrase[];\n}\n\nexport function compressRelz(\n  input: number[],\n  prefixLength: number\n): RelzResult {\n  const [prefixPhrases, suffixPhrases] = [\n    ...compressRlzPrefix(input, prefixLength),\n  ];\n  const firstPassPhrases = [...prefixPhrases, ...suffixPhrases];\n  const [mapping, metaSymbols] = relzMapping(firstPassPhrases, input);\n  const metaSymbolPhrases = [...compressLz77(metaSymbols)];\n  const resultPhrases = extractLzLikeParsing(\n    metaSymbolPhrases,\n    mapping,\n    metaSymbols,\n    0\n  );\n\n  return {\n    firstPassPhrases,\n    metaSymbols,\n    metaSymbolPhrases,\n    phrases: resultPhrases,\n  };\n}\n\nexport interface RelzRecPass {\n  input: number[];\n  prefixPhrases: Phrase[];\n  suffixPhrases: Phrase[];\n  suffixMetaSymbols: number[];\n  suffixMetaSymbolsPhrases: Phrase[];\n  suffixPhrasesCompressed: Phrase[];\n}\nexport interface RelzRecursiveResult {\n  passes: RelzRecPass[];\n  phrases: Phrase[];\n}\n\nexport function compressRelzRecursive(\n  input: number[],\n  prefixLength: number,\n  recursionLimit: number | undefined = undefined\n): RelzRecursiveResult {\n  if (recursionLimit === 0) {\n    return {\n      passes: [],\n      phrases: input.map((c, pos) => ({\n        type: \"literal\",\n        pos,\n        symbol: c,\n        l: 1,\n      })),\n    };\n  }\n\n  const [prefixPhrases, suffixPhrases] = [\n    ...compressRlzPrefix(input, prefixLength),\n  ];\n  if (suffixPhrases.length > 0) {\n    const [mapping, metaSymbols] = relzMapping(\n      suffixPhrases,\n      input.slice(0, prefixLength)\n    );\n    const result = compressRelzRecursive(\n      metaSymbols,\n      prefixLength,\n      recursionLimit && recursionLimit - 1\n    );\n    const metaSymbolsPhrases = result.phrases;\n    const suffixPhrasesCompressed = extractLzLikeParsing(\n      metaSymbolsPhrases,\n      mapping,\n      metaSymbols,\n      prefixLength\n    );\n    const phrases = [...prefixPhrases, ...suffixPhrasesCompressed];\n\n    return {\n      passes: [\n        {\n          input,\n          prefixPhrases,\n          suffixPhrases,\n          suffixMetaSymbols: metaSymbols,\n          suffixMetaSymbolsPhrases: metaSymbolsPhrases,\n          suffixPhrasesCompressed,\n        },\n        ...result.passes,\n      ],\n      phrases,\n    };\n  } else {\n    return {\n      passes: [\n        {\n          input,\n          prefixPhrases,\n          suffixPhrases: [],\n          suffixMetaSymbols: [],\n          suffixMetaSymbolsPhrases: [],\n          suffixPhrasesCompressed: [],\n        },\n      ],\n      phrases: prefixPhrases,\n    };\n  }\n}\n","function Character(props: { character: string }) {\n  return (\n    <div\n      style={{\n        display: \"inline-block\",\n        width: \"30px\",\n        height: \"30px\",\n        border: \"1px solid black\",\n        textAlign: \"center\",\n        verticalAlign: \"middle\",\n        lineHeight: \"30px\",\n      }}\n    >\n      {props.character}\n    </div>\n  );\n}\n\nexport function VisualizePhrases(): JSX.Element {\n  return (\n    <div>\n      <Character character=\"A\"></Character>\n      <Character character=\"A\"></Character>\n    </div>\n  );\n}\n","import Card from \"react-bootstrap/Card\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport { stringToCodePoints } from \"./algorithms/utils\";\nimport {\n  compressLz77,\n  compressRelz,\n  compressRelzRecursive,\n  compressRlz,\n  compressRlzPrefix,\n  compressWithSlidingWindow,\n  Phrase,\n  RlzPhrase,\n} from \"./algorithms/compression\";\nimport React from \"react\";\n\nimport {VisualizePhrases} from \"./visualization\"\n\nexport type CompressorType =\n  | \"lz77\"\n  | \"lz-sw\"\n  | \"rlz\"\n  | \"rlz-pref\"\n  | \"relz\"\n  | \"relz-rec\";\n\nexport type CompressorSettings =\n  | {\n      type: \"lz77\";\n    }\n  | {\n      type: \"lz-sw\";\n      windowSize?: number;\n    }\n  | {\n      type: \"rlz\";\n      reference: string;\n    }\n  | {\n      type: \"rlz-pref\";\n      prefixLength: number;\n    }\n  | {\n      type: \"relz\";\n      prefixLength: number;\n    }\n  | {\n      type: \"relz-rec\";\n      prefixLength: number;\n      recursionLimit?: number;\n    };\n\nexport function initialCompressorSettings(\n  type: CompressorType\n): CompressorSettings {\n  if (type === \"lz77\") {\n    return { type: \"lz77\" };\n  } else if (type === \"lz-sw\") {\n    return { type: \"lz-sw\", windowSize: 5 };\n  } else if (type === \"rlz\") {\n    return { type: \"rlz\", reference: \"\" };\n  } else if (type === \"rlz-pref\") {\n    return { type: \"rlz-pref\", prefixLength: 5 };\n  } else if (type === \"relz\") {\n    return { type: \"relz\", prefixLength: 5 };\n  } /* else if (type === \"relz-rec\") */ else {\n    return { type: \"relz-rec\", prefixLength: 5 };\n  }\n}\n\nexport interface Compressor {\n  type: CompressorType;\n  title: string;\n  needsReference: boolean;\n  needsPrefixSize: boolean;\n  needsWindowSize: boolean;\n  needsRecursionLimit: boolean;\n}\n\nexport const availableCompressors: { [type in CompressorType]: Compressor } = {\n  lz77: {\n    type: \"lz77\",\n    title: \"LZ77\",\n    needsReference: false,\n    needsPrefixSize: false,\n    needsWindowSize: false,\n    needsRecursionLimit: false,\n  },\n  \"lz-sw\": {\n    type: \"lz-sw\",\n    title: \"LZ with sliding window\",\n    needsReference: false,\n    needsPrefixSize: false,\n    needsWindowSize: true,\n    needsRecursionLimit: false,\n  },\n  rlz: {\n    type: \"rlz\",\n    title: \"RLZ\",\n    needsReference: true,\n    needsPrefixSize: false,\n    needsWindowSize: false,\n    needsRecursionLimit: false,\n  },\n  \"rlz-pref\": {\n    type: \"rlz-pref\",\n    title: \"RLZ using prefix\",\n    needsReference: false,\n    needsPrefixSize: true,\n    needsWindowSize: false,\n    needsRecursionLimit: false,\n  },\n  relz: {\n    type: \"relz\",\n    title: \"ReLZ\",\n    needsReference: false,\n    needsPrefixSize: true,\n    needsWindowSize: false,\n    needsRecursionLimit: false,\n  },\n  \"relz-rec\": {\n    type: \"relz-rec\",\n    title: \"Recursive ReLZ\",\n    needsReference: false,\n    needsPrefixSize: true,\n    needsWindowSize: false,\n    needsRecursionLimit: true,\n  },\n};\n\ninterface CompressorSettingsEditorProps {\n  current: CompressorSettings;\n  onChange?: (settings: CompressorSettings) => void;\n}\n\nexport function CompressorSettingEditor(\n  props: CompressorSettingsEditorProps\n): JSX.Element {\n  function update(settings: CompressorSettings) {\n    if (props.onChange) {\n      props.onChange(settings);\n    }\n  }\n\n  if (props.current.type === \"lz77\") {\n    return (\n      <Card>\n        <Card.Header>LZ77</Card.Header>\n        <Card.Body>no settings</Card.Body>\n      </Card>\n    );\n  } else if (props.current.type === \"lz-sw\") {\n    const windowSize = props.current.windowSize;\n    return (\n      <Card>\n        <Card.Header>LZ with sliding window</Card.Header>\n        <Card.Body>\n          <Row>\n            <Col>Window size:</Col>\n            <Col>\n              <input\n                type=\"number\"\n                min=\"0\"\n                value={windowSize}\n                onChange={(e) =>\n                  update({\n                    type: \"lz-sw\",\n                    windowSize: parseInt(e.target.value),\n                  })\n                }\n              ></input>\n            </Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.current.type === \"rlz\") {\n    return (\n      <Card>\n        <Card.Header>Relative LZ</Card.Header>\n        <Card.Body>\n          <Row>\n            <Col>Reference:</Col>\n            <Col>\n              <input\n                value={props.current.reference}\n                onChange={(e) =>\n                  update({\n                    type: \"rlz\",\n                    reference: e.target.value,\n                  })\n                }\n              ></input>\n            </Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.current.type === \"rlz-pref\") {\n    return (\n      <Card>\n        <Card.Header>RLZ with prefix</Card.Header>\n        <Card.Body>\n          <Row>\n            <Col>Prefix length:</Col>\n            <Col>\n              <input\n                value={props.current.prefixLength}\n                type=\"number\"\n                min=\"0\"\n                onChange={(e) =>\n                  update({\n                    type: \"rlz-pref\",\n                    prefixLength: parseInt(e.target.value),\n                  })\n                }\n              ></input>\n            </Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.current.type === \"relz\") {\n    return (\n      <Card>\n        <Card.Header>ReLZ</Card.Header>\n        <Card.Body>\n          <Row>\n            <Col>Prefix length:</Col>\n            <Col>\n              <input\n                type=\"number\"\n                min=\"0\"\n                value={props.current.prefixLength}\n                onChange={(e) =>\n                  update({\n                    type: \"relz\",\n                    prefixLength: parseInt(e.target.value),\n                  })\n                }\n              ></input>\n            </Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.current.type === \"relz-rec\") {\n    const { prefixLength, recursionLimit } = props.current;\n    return (\n      <Card>\n        <Card.Header>Recursive ReLZ</Card.Header>\n        <Card.Body>\n          <Row>\n            <Col>Prefix length:</Col>\n            <Col>\n              <input\n                type=\"number\"\n                min=\"0\"\n                value={props.current.prefixLength}\n                onChange={(e) =>\n                  update({\n                    type: \"relz-rec\",\n                    prefixLength: parseInt(e.target.value),\n                    recursionLimit,\n                  })\n                }\n              ></input>\n            </Col>\n          </Row>\n          <Row>\n            <Col>Recursion limit:</Col>\n            <Col>\n              <input\n                type=\"number\"\n                min=\"0\"\n                value={props.current.recursionLimit}\n                onChange={(e) =>\n                  update({\n                    type: \"relz-rec\",\n                    prefixLength,\n                    recursionLimit: parseInt(e.target.value),\n                  })\n                }\n              ></input>\n            </Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  }\n\n  throw new Error(\"invalid compressor type\");\n}\n\ninterface CompressorOutputProps {\n  input: string;\n  settings: CompressorSettings;\n}\n\nexport function CompressorOutput(props: CompressorOutputProps): JSX.Element {\n  const codePoints = stringToCodePoints(props.input);\n\n  function phrasesToString(phrases: Phrase[]) {\n    return phrases.map((p) => {\n      if (p.type === \"copy\") {\n        return `(${p.p+1}, ${p.l})`;\n      } else {\n        const symbol = String.fromCodePoint(p.symbol);\n        return `(${symbol}, 0)`;\n      }\n    });\n  }\n\n  function rlzPhrasesToString(phrases: RlzPhrase[]) {\n    return phrases.map((p) => {\n      if (p.type === \"copy\") {\n        return `(${p.p+1}, ${p.l})`;\n      } else {\n        const symbol = String.fromCodePoint(p.symbol);\n        return `(${symbol}, 0)`;\n      }\n    });\n  }\n\n  if (props.settings.type === \"lz77\") {\n    const phrases = [...compressLz77(codePoints)];\n    return (\n      <Card style={{ height: \"100%\" }}>\n        <Card.Body>\n          <Row>\n            <Col>{phrasesToString(phrases).join(\", \")}</Col>\n          </Row>\n          <Row>\n            <Col>z = {phrases.length}</Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.settings.type === \"lz-sw\") {\n    const { windowSize } = props.settings;\n    const phrases =\n      windowSize !== undefined && !isNaN(windowSize)\n        ? [...compressWithSlidingWindow(codePoints, windowSize)]\n        : undefined;\n    return (\n      <Card style={{ height: \"100%\" }}>\n        <Card.Body>\n          <Row>\n            <Col>\n                <VisualizePhrases></VisualizePhrases>\n            </Col>\n          </Row>\n          <Row>\n            <Col>{phrasesToString(phrases || []).join(\", \")}</Col>\n          </Row>\n          <Row>\n            <Col>z = {phrases?.length ?? \"?\"}</Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.settings.type === \"rlz\") {\n    const { reference } = props.settings;\n    const referenceCodePoints = stringToCodePoints(reference);\n    const phrases = [...compressRlz(codePoints, referenceCodePoints)];\n    return (\n      <Card style={{ height: \"100%\" }}>\n        <Card.Body>\n          <Row>\n            <Col>{rlzPhrasesToString(phrases).join(\", \")}</Col>\n          </Row>\n          <Row>\n            <Col>\n              z = {phrases?.length ?? \"?\"} (+ {reference.length})\n            </Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.settings.type === \"rlz-pref\") {\n    const { prefixLength } = props.settings;\n    const [prefixPhrases, suffixPhrases] = compressRlzPrefix(\n      codePoints,\n      prefixLength\n    );\n    const phrases = [...prefixPhrases, ...suffixPhrases];\n    return (\n      <Card style={{ height: \"100%\" }}>\n        <Card.Body>\n          <Row>\n            <Col>{phrasesToString(phrases).join(\", \")}</Col>\n          </Row>\n          <Row>\n            <Col>z = {phrases?.length ?? \"?\"}</Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.settings.type === \"relz\") {\n    const { prefixLength } = props.settings;\n    const phrases = compressRelz(codePoints, prefixLength);\n    return (\n      <Card style={{ height: \"100%\" }}>\n        <Card.Body>\n          <Row>\n            <Col>{phrasesToString(phrases.phrases).join(\", \")}</Col>\n          </Row>\n          <Row>\n            <Col>z = {phrases?.phrases.length ?? \"?\"}</Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  } else if (props.settings.type === \"relz-rec\") {\n    const { prefixLength, recursionLimit } = props.settings;\n    const {phrases} = compressRelzRecursive(\n      codePoints,\n      prefixLength,\n      recursionLimit\n    );\n    return (\n      <Card style={{ height: \"100%\" }}>\n        <Card.Body>\n          <Row>\n            <Col>{phrasesToString(phrases).join(\", \")}</Col>\n          </Row>\n          <Row>\n            <Col>z = {phrases?.length ?? \"?\"}</Col>\n          </Row>\n        </Card.Body>\n      </Card>\n    );\n  }\n\n  throw new Error(\"invalid compressor type\");\n}\n","import React, { useState } from \"react\";\n\nimport Button from \"react-bootstrap/Button\";\nimport Card from \"react-bootstrap/Card\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport { tikzRenderLz77 } from \"./algorithms/tikz\";\nimport { compressRlzPrefix } from \"./algorithms/compression\";\nimport { stringToCodePoints } from \"./algorithms/utils\";\nimport Dropdown from \"react-bootstrap/Dropdown\";\nimport ButtonGroup from \"react-bootstrap/ButtonGroup\";\nimport {\n  availableCompressors,\n  CompressorOutput,\n  CompressorSettingEditor,\n  CompressorSettings,\n  initialCompressorSettings,\n} from \"./compressors\";\n\ntype CompressorType =\n  | \"lz77\"\n  | \"lz-sw\"\n  | \"rlz\"\n  | \"rlz-pref\"\n  | \"relz\"\n  | \"relz-rec\";\n\nexport function Compare() {\n  const [input, setInput] = useState(\"AAABBBCCCC\");\n  // const phrases = [...compress(input)]\n  const codePoints = stringToCodePoints(input);\n  const [prefixPhrases, suffixPhrases] = compressRlzPrefix(codePoints, 4);\n  const phrases = [...prefixPhrases, ...suffixPhrases];\n  const tikz = tikzRenderLz77(input, phrases);\n  const [compressorType, setCompressorType] = useState<CompressorType>(\"lz77\");\n\n  const [compressorSettings, setCompressorSettings] = useState<\n    CompressorSettings[]\n  >([\n    initialCompressorSettings(\"lz77\"),\n    initialCompressorSettings(\"lz-sw\"),\n    initialCompressorSettings(\"rlz\"),\n    initialCompressorSettings(\"rlz-pref\"),\n    initialCompressorSettings(\"relz\"),\n    initialCompressorSettings(\"relz-rec\"),\n  ]);\n\n  function addCompressor() {\n    setCompressorSettings([\n      ...compressorSettings,\n      initialCompressorSettings(compressorType),\n    ]);\n  }\n\n  return (\n    <>\n      <Container>\n        <Row>\n          <Col>\n            <Card>\n              {/* <Card.Body>\n                {phrases\n                  .map((p) => {\n                    if (p.type === \"copy\") {\n                      return `(${p.p+1}, ${p.l})`;\n                    } else {\n                      return `(${p.symbol}, 0)`;\n                    }\n                  })\n                  .join(\" \")}\n              </Card.Body> */}\n            </Card>\n          </Col>\n        </Row>\n        <Row>\n          <Col>\n            <Card>\n              <Card.Body>\n                Input:{\" \"}\n                <input\n                  type=\"text\"\n                  onChange={(e) => setInput(e.target.value)}\n                  value={input}\n                ></input>\n              </Card.Body>\n            </Card>\n          </Col>\n        </Row>\n        <Row>\n          <Col lg=\"6\">\n            <Row>\n              <Col>\n                <h1>Compressors</h1>\n              </Col>\n              <Col>\n                <Dropdown as={ButtonGroup}>\n                  <Button onClick={addCompressor}>\n                    {\"Add \" + availableCompressors[compressorType].title}\n                  </Button>\n\n                  <Dropdown.Toggle split />\n\n                  <Dropdown.Menu>\n                    <Dropdown.Item onClick={() => setCompressorType(\"lz77\")}>\n                      LZ\n                    </Dropdown.Item>\n                    <Dropdown.Item onClick={() => setCompressorType(\"lz-sw\")}>\n                      LZ with sliding window{\" \"}\n                    </Dropdown.Item>\n                    <Dropdown.Item onClick={() => setCompressorType(\"rlz\")}>\n                      {\" \"}\n                      RLZ\n                    </Dropdown.Item>\n                    <Dropdown.Item onClick={() => setCompressorType(\"rlz-pref\")}>\n                      RLZ with prefix\n                    </Dropdown.Item>\n                    <Dropdown.Item onClick={() => setCompressorType(\"relz\")}>\n                      ReLZ\n                    </Dropdown.Item>\n                    <Dropdown.Item\n                      onClick={() => setCompressorType(\"relz-rec\")}\n                    >\n                      Recursive ReLZ\n                    </Dropdown.Item>\n                  </Dropdown.Menu>\n                </Dropdown>\n              </Col>\n            </Row>\n          </Col>\n          <Col lg=\"6\">\n            <h1>Outputs</h1>\n          </Col>\n        </Row>\n\n        {compressorSettings.map((settings, idx) => (\n          <Row className=\"mt-3\">\n            <Col lg=\"6\">\n              <CompressorSettingEditor\n                current={settings}\n                onChange={settings => setCompressorSettings(compressorSettings.map((v, i) => idx === i ? settings : v))}\n              ></CompressorSettingEditor>\n            </Col>\n            <Col lg=\"6\">\n              <CompressorOutput settings={settings} input={input}></CompressorOutput>\n            </Col>\n          </Row>\n        ))}\n      </Container>\n    </>\n  );\n}\n","import { Phrase } from \"./compression\";\n\nexport function tikzRenderLz77(input: string, phrases: Phrase[]): string {\n  let output = `\\\\begin{tabular}{c c c}\n    \\\\toprule\n    $i$ & Input    & $f_i = (p_i, l_i)$ \\\\\\\\\n    \\\\midrule\n    & \n    \\\\begin{tikzpicture}[baseline=-2]\n`;\n\n  for (let i = 0; i < input.length; i++) {\n    output += `        \\\\node[index] (${i + 1})`;\n    if (i > 0) {\n      output += ` [right of=${i}]`;\n    }\n    output += ` {${i + 1}};\\n`;\n  }\n  output += `    \\\\end{tikzpicture}\n    & \\\\\\\\\n`;\n\n  let done = 0;\n  for (let i = 0; i < phrases.length; i++) {\n    const phrase = phrases[i];\n    output += `    ${i + 1} &\n        \\\\begin{tikzpicture}[baseline=-2]\n`;\n    for (let h = 0; h < input.length; h++) {\n      output += `            \\\\node[squarednode`;\n      if (h < done) {\n        output += \", used\";\n      }\n      output += `] (${h + 1})`;\n      if (h > 0) {\n        output += ` [right of=${h}]`;\n      }\n      output += ` {${input[h]}};\\n`;\n    }\n\n    output += \"            \\\\node[fit=\";\n    for (let h = 0; h < phrase.l; h++) {\n      output += `(${done + h + 1})`;\n    }\n    output += \", current]{};\\n\";\n\n    output += `            \\\\addvmargin{1mm};\n        \\\\end{tikzpicture}\n            & `;\n\n    if (phrase.type === \"literal\") {\n      output += `(${phrase.symbol}, 0) \\\\\\\\\\n`;\n    } else {\n      output += `(${phrase.p + 1}, ${phrase.l}) \\\\\\\\\\n`;\n    }\n\n    done += phrase.l;\n  }\n  output += `    \\\\bottomrule\n\\\\end{tabular}\n    `;\n\n  return output;\n}\n","const TARGET_COLOR = \"#E1BE6A\";\nconst SOURCE_COLOR = \"#40B0A6\";\n\nexport function SharedDefinitions() {\n  return (\n    <defs>\n      <marker\n        id=\"arrowhead\"\n        markerWidth=\"100\"\n        markerHeight=\"7\"\n        refX=\"9\"\n        refY=\"3.5\"\n        orient=\"auto\"\n      >\n        <polygon points=\"0 0, 10 3.5, 0 7\" />\n      </marker>\n\n      <linearGradient id=\"split-color\" gradientTransform=\"rotate(45)\">\n        <stop offset=\"75%\" stopColor={TARGET_COLOR} />\n        <stop offset=\"75%\" stopColor={SOURCE_COLOR} />\n      </linearGradient>\n    </defs>\n  );\n}\n\nexport interface ArrowProps {\n  x1: number;\n  x2: number;\n  y: number;\n}\n\nexport function Arrow(props: ArrowProps) {\n  const { x1, x2, y } = props;\n  const l = x2 - x1;\n  return (\n    <path\n      d={`M ${x1} ${y} v -20 h ${l} v 19`}\n      marker-end=\"url(#arrowhead)\"\n      stroke=\"black\"\n      fill=\"none\"\n    />\n  );\n}\n\nexport interface ArrowProps2 {\n  x1: number;\n  y1: number;\n  x2: number;\n  y2: number;\n  straight?: boolean;\n}\n\nexport function Arrow2(props: ArrowProps2) {\n  const { x1, y1, x2, y2, straight } = props;\n\n  if (straight) {\n    const v1 = y1 < y2 ? 10 : -10;\n    const v2 = y1 < y2 ? 20 : -20;\n\n    return (\n      <path\n        d={`M ${x1} ${y1} v ${v1} L ${x2} ${y2 - 20} v ${v2}`}\n        markerEnd=\"url(#arrowhead)\"\n        stroke=\"black\"\n        fill=\"none\"\n      />\n    );\n  } else {\n    const l = x2 - x1;\n    const h = (y2 - y1) / 2;\n\n    const v1 = y2 < y1 ? h : -h;\n    const v2 = y2 < y1 ? h : -h;\n    return (\n      <path\n        d={`m ${x1} ${y1} v ${v1} h ${l} v ${v2}`}\n        marker-end=\"url(#arrowhead)\"\n        stroke=\"black\"\n        fill=\"none\"\n      />\n    );\n  }\n}\n\nexport type CharacterColor = \"none\" | \"source\" | \"target\" | \"source-target\";\n\nexport interface CharacterProps {\n  x: number;\n  y: number;\n  w?: number;\n  h?: number;\n  text: string;\n  color?: CharacterColor;\n}\n\nexport function Character(props: CharacterProps) {\n  const { x, y, text, color } = props;\n  const w = props.w || 30;\n  const h = props.h || 30;\n  const fill =\n    color === \"source\"\n      ? SOURCE_COLOR\n      : color === \"target\"\n      ? TARGET_COLOR\n      : color === \"source-target\"\n      ? \"url(#split-color)\"\n      : \"none\";\n  return (\n    <>\n      <rect x={x} y={y} width={w} height={h} fill={fill} stroke=\"black\" />\n      <foreignObject x={x} y={y} width={w} height={h}>\n        <div\n          style={{\n            //   width: \"30px\",\n            //   height: \"30px\",\n            overflowY: \"auto\",\n            textAlign: \"center\",\n            verticalAlign: \"middle\",\n            lineHeight: `${h}px`,\n            userSelect: \"none\",\n          }}\n        >\n          {text}\n        </div>\n      </foreignObject>\n    </>\n  );\n}\n\nexport interface CurlyBraceProps {\n  x1: number;\n  y1: number;\n  x2: number;\n  y2: number;\n  w: number;\n  q: number;\n}\n\nexport function CurlyBrace(props: CurlyBraceProps) {\n  const { x1, y1, x2, y2, w, q } = props;\n  var dx = x1 - x2;\n  var dy = y1 - y2;\n  var len = Math.sqrt(dx * dx + dy * dy);\n  dx = dx / len;\n  dy = dy / len;\n\n  //Calculate Control Points of path,\n  const qx1 = x1 + q * w * dy;\n  const qy1 = y1 - q * w * dx;\n  const qx2 = x1 - 0.25 * len * dx + (1 - q) * w * dy;\n  const qy2 = y1 - 0.25 * len * dy - (1 - q) * w * dx;\n  const tx1 = x1 - 0.5 * len * dx + w * dy;\n  const ty1 = y1 - 0.5 * len * dy - w * dx;\n  const qx3 = x2 + q * w * dy;\n  const qy3 = y2 - q * w * dx;\n  const qx4 = x1 - 0.75 * len * dx + (1 - q) * w * dy;\n  const qy4 = y1 - 0.75 * len * dy - (1 - q) * w * dx;\n\n  const path = `M ${x1} ${y1} Q ${qx1} ${qy1} ${qx2} ${qy2} T ${tx1} ${ty1} M ${x2} ${y2} Q ${qx3} ${qy3} ${qx4} ${qy4} T ${tx1} ${ty1}`;\n\n  return <path d={path} stroke=\"black\" fill=\"none\"></path>;\n}\n\nexport interface PhraseDisplayProps {\n  x: number;\n  y: number;\n  l: number;\n  text: string;\n  w?: number;\n}\n\nexport function PhraseDisplay(props: PhraseDisplayProps) {\n  const { x, y, l, text } = props;\n  if (l === 1) {\n    return (\n      <foreignObject x={x - 20} y={y} width=\"60\" height=\"40\">\n        <div\n          style={{\n            //   width: \"30px\",\n            //   height: \"30px\",\n            overflowY: \"auto\",\n            textAlign: \"center\",\n            verticalAlign: \"middle\",\n            lineHeight: \"40px\",\n            userSelect: \"none\",\n            transform: \"rotate(-45deg)\",\n          }}\n        >\n          {text}\n        </div>\n      </foreignObject>\n    );\n  } else {\n    const x1 = x + 3;\n    const x2 = x + l * 30 - 3;\n    const w = props.w ?? 50;\n    return (\n      <>\n        <CurlyBrace x1={x1} x2={x2} y1={y} y2={y} w={10} q={0.6}></CurlyBrace>\n        <foreignObject\n          x={x1 + Math.abs(x2 - x1) / 2 - w / 2}\n          y={y}\n          width={w}\n          height=\"40\"\n        >\n          <div\n            style={{\n              //   width: \"30px\",\n              //   height: \"30px\",\n              overflowY: \"auto\",\n              textAlign: \"center\",\n              verticalAlign: \"middle\",\n              lineHeight: \"40px\",\n              userSelect: \"none\",\n            }}\n          >\n            {text}\n          </div>\n        </foreignObject>\n      </>\n    );\n  }\n}\n\nexport interface ShortPhraseProps {\n  x: number;\n  y: number;\n  text: string;\n}\n    \nexport function ShortPhrase(props: ShortPhraseProps) {\n  const { x, y, text } = props;\n  return (\n    <foreignObject x={x} y={y} width=\"60\" height=\"40\">\n      <div\n        style={{\n          //   width: \"30px\",\n          //   height: \"30px\",\n          overflowY: \"auto\",\n          textAlign: \"center\",\n          verticalAlign: \"middle\",\n          lineHeight: \"40px\",\n          userSelect: \"none\",\n          transform: \"rotate(-45deg)\",\n        }}\n      >\n        {text}\n      </div>\n    </foreignObject>\n  );\n}\n\nexport interface CopyingPhraseProps {\n  x1: number;\n  x2: number;\n  y: number;\n  p: number;\n  l: number;\n  w?: number;\n}\n\nexport function CopyingPhrase(props: CopyingPhraseProps) {\n  const { x1, x2, y, p, l } = props;\n  const w = props.w ?? 50;\n\n  return (\n    <>\n      <CurlyBrace x1={x1} x2={x2} y1={y} y2={y} w={10} q={0.6}></CurlyBrace>\n      <foreignObject\n        x={x1 + Math.abs(x2 - x1) / 2 - w / 2}\n        y={y}\n        width={w}\n        height=\"40\"\n      >\n        <div\n          style={{\n            //   width: \"30px\",\n            //   height: \"30px\",\n            overflowY: \"auto\",\n            textAlign: \"center\",\n            verticalAlign: \"middle\",\n            lineHeight: \"40px\",\n            userSelect: \"none\",\n          }}\n        >\n          {`(${p}, ${l})`}\n        </div>\n      </foreignObject>\n    </>\n  );\n}\n","import { sum, take } from \"lodash\";\nimport React from \"react\";\nimport { Phrase } from \"../algorithms/compression\";\nimport { Lz77VisualizationData } from \"./common\";\nimport {\n  Arrow,\n  Character,\n  CharacterColor,\n  CopyingPhrase,\n  CopyingPhraseProps,\n  SharedDefinitions,\n  ShortPhrase,\n  ShortPhraseProps,\n} from \"./drawing\";\n\nexport interface Lz77VisualizationProps {\n  data: Lz77VisualizationData;\n  currentPhrase?: number;\n}\n\nexport function Lz77Visualization(props: Lz77VisualizationProps) {\n  const { data, currentPhrase } = props;\n  const { input, phrases } = data;\n\n  const colors: CharacterColor[] = new Array(input.length).fill(\"none\");\n  let arrowStart: number | undefined;\n  let arrowTarget: number | undefined;\n  if (currentPhrase !== undefined && currentPhrase < phrases.length) {\n    const phrase = phrases[currentPhrase];\n    if (phrase.type === \"copy\") {\n      for (let i = 0; i < phrase.l; i++) {\n        colors[phrase.p + i] = \"source\";\n      }\n      arrowTarget = phrase.p;\n    }\n    const phrasePos = sum(take(phrases, currentPhrase).map((p) => p.l));\n    arrowStart = phrasePos;\n    for (let i = 0; i < phrase.l; i++) {\n      colors[phrasePos + i] =\n        colors[phrasePos + i] === \"none\" ? \"target\" : \"source-target\";\n    }\n  }\n\n  const shortPhrases: ShortPhraseProps[] = [];\n  const copyingPhrases: CopyingPhraseProps[] = [];\n  if (currentPhrase !== undefined) {\n    let currentPos = 0;\n    take(phrases, currentPhrase + 1).forEach((p) => {\n      if (p.type === \"literal\") {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 90,\n          text: `(${String.fromCodePoint(p.symbol)},0)`,\n        });\n      } else if (p.l === 1) {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 90,\n          text: `(${p.p},${p.l})`,\n        });\n      } else {\n        copyingPhrases.push({\n          x1: currentPos * 30 + 22,\n          x2: currentPos * 30 + p.l * 30 + 18,\n          y: 90,\n          ...p,\n        });\n      }\n      currentPos += p.l;\n    });\n  }\n\n  return (\n    <svg height=\"100%\" width=\"100%\">\n      <SharedDefinitions></SharedDefinitions>\n\n      {input.split(\"\").map((char, i) => (\n        <Character\n          key={i}\n          x={i * 30 + 20}\n          y={50}\n          text={char}\n          color={colors[i]}\n        ></Character>\n      ))}\n\n      {arrowStart !== undefined && arrowTarget !== undefined && (\n        <Arrow\n          x1={arrowStart * 30 + 35}\n          x2={arrowTarget * 30 + 35}\n          y={50}\n        ></Arrow>\n      )}\n\n      {shortPhrases.map((props, i) => (\n        <ShortPhrase key={i} {...props}></ShortPhrase>\n      ))}\n\n      {copyingPhrases.map((props, i) => (\n        <CopyingPhrase key={i} {...props}></CopyingPhrase>\n      ))}\n    </svg>\n  );\n}\n","import { sum, take } from \"lodash\";\nimport React from \"react\";\nimport { RlzPhrase } from \"../algorithms/compression\";\nimport { RlzVisualizationData } from \"./common\";\nimport { CharacterColor, ShortPhraseProps, CopyingPhraseProps, Arrow, Character, CopyingPhrase, SharedDefinitions, ShortPhrase, Arrow2 } from \"./drawing\";\n\nexport interface RlzVisualizationProps {\n  data: RlzVisualizationData;\n  currentPhrase?: number;\n}\n\nexport function RlzVisualization(props: RlzVisualizationProps) {\n  const { data, currentPhrase } = props;\n  const {input, reference, phrases} = data;\n\n  const colors: CharacterColor[] = new Array(input.length).fill(\"none\");\n  const referenceColors: CharacterColor[] = new Array(reference.length).fill(\"none\");\n  let arrowStart: number | undefined;\n  let arrowTarget: number | undefined;\n  if (currentPhrase !== undefined && currentPhrase < phrases.length) {\n    const phrase = phrases[currentPhrase];\n    if (phrase.type === \"copy\") {\n      for (let i = 0; i < phrase.l; i++) {\n        referenceColors[phrase.p + i] = \"source\";\n      }\n      arrowTarget = phrase.p;\n    }\n    const phrasePos = sum(take(phrases, currentPhrase).map((p) => p.l));\n    arrowStart = phrasePos;\n    for (let i = 0; i < phrase.l; i++) {\n      colors[phrasePos + i] = \"target\"\n    }\n  }\n\n  const shortPhrases: ShortPhraseProps[] = [];\n  const copyingPhrases: CopyingPhraseProps[] = [];\n  if (currentPhrase !== undefined) {\n    let currentPos = 0;\n    take(phrases, currentPhrase + 1).forEach((p) => {\n      if (p.type === \"literal\") {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 130,\n          text: `(${String.fromCodePoint(p.symbol)},0)`,\n        });\n      } else if (p.l === 1) {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 130,\n          text: `(${p.p},${p.l})`,\n        });\n      } else {\n        copyingPhrases.push({\n          x1: currentPos * 30 + 22,\n          x2: currentPos * 30 + p.l * 30 + 18,\n          y: 130,\n          ...p,\n        });\n      }\n      currentPos += p.l;\n    });\n  }\n\n  return (\n    <svg height=\"200\" width=\"100%\">\n      <SharedDefinitions></SharedDefinitions>\n\n           {reference.split(\"\").map((char, i) => (\n        <Character\n          x={i * 30 + 20}\n          y={10}\n          text={char}\n          color={referenceColors[i]}\n        ></Character>\n      ))}\n\n      {input.split(\"\").map((char, i) => (\n        <Character\n          x={i * 30 + 20}\n          y={90}\n          text={char}\n          color={colors[i]}\n        ></Character>\n      ))}\n\n      {arrowStart !== undefined && arrowTarget !== undefined && (\n        <Arrow2\n          x1={arrowStart * 30 + 35}\n          x2={arrowTarget * 30 + 35}\n          y1={90}\n          y2={50}\n        ></Arrow2>\n      )}\n\n      {shortPhrases.map((props) => (\n        <ShortPhrase {...props}></ShortPhrase>\n      ))}\n\n      {copyingPhrases.map((props) => (\n        <CopyingPhrase {...props}></CopyingPhrase>\n      ))}\n    </svg>\n  );\n}\n","import { sum, take, zip } from \"lodash\";\nimport React from \"react\";\nimport { RelzVisualizationData } from \"./common\";\nimport {\n  CharacterColor,\n  ShortPhraseProps,\n  CopyingPhraseProps,\n  Arrow,\n  Character,\n  CopyingPhrase,\n  SharedDefinitions,\n  ShortPhrase,\n  Arrow2,\n} from \"./drawing\";\n\nexport interface RelzVisualizationProps {\n  data: RelzVisualizationData;\n  currentPhrase?: number;\n}\n\nexport function RelzVisualization(props: RelzVisualizationProps) {\n  const { data, currentPhrase } = props;\n  const { input, phrases, firstPassPhrases, metaSymbolPhrases } = data;\n  const finalStep = currentPhrase === data.stepsCount;\n\n  const colors: CharacterColor[] = new Array(input.length).fill(\"none\");\n  let arrowStart: number | undefined;\n  let arrowTarget: number | undefined;\n  if (currentPhrase !== undefined && currentPhrase < firstPassPhrases.length) {\n    const phrase = firstPassPhrases[currentPhrase];\n    if (phrase.type === \"copy\") {\n      for (let i = 0; i < phrase.l; i++) {\n        colors[phrase.p + i] = \"source\";\n      }\n      arrowTarget = phrase.p;\n    }\n    const phrasePos = sum(\n      take(firstPassPhrases, currentPhrase).map((p) => p.l)\n    );\n    arrowStart = phrasePos;\n    for (let i = 0; i < phrase.l; i++) {\n      colors[phrasePos + i] =\n        colors[phrasePos + i] === \"none\" ? \"target\" : \"source-target\";\n    }\n  }\n\n  const shortPhrases: ShortPhraseProps[] = [];\n  const copyingPhrases: CopyingPhraseProps[] = [];\n  if (currentPhrase !== undefined) {\n    let currentPos = 0;\n    take(firstPassPhrases, currentPhrase + 1).forEach((p) => {\n      if (p.type === \"literal\") {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 90,\n          text: `(${String.fromCodePoint(p.symbol)},0)`,\n        });\n      } else if (p.l === 1) {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 90,\n          text: `(${p.p},${p.l})`,\n        });\n      } else {\n        copyingPhrases.push({\n          x1: currentPos * 30 + 22,\n          x2: currentPos * 30 + p.l * 30 + 18,\n          y: 90,\n          ...p,\n        });\n      }\n      currentPos += p.l;\n    });\n  }\n\n  const mappingArrows: [number, number][] = [];\n  if (currentPhrase === firstPassPhrases.length) {\n    let currentPos = 0;\n    firstPassPhrases.forEach((p, i) => {\n      mappingArrows.push([currentPos * 30 + 35 + (p.l - 1) * 15, i * 30 + 35]);\n      currentPos += p.l;\n    });\n  }\n\n  // TODO: convert meta symbols to lower case characters?\n  const metaSymbols =\n    currentPhrase && currentPhrase >= firstPassPhrases.length\n      ? data.metaSymbols.map((s) => String(s))\n      : [];\n  const metaColors: CharacterColor[] = new Array(metaSymbols.length).fill(\n    \"none\"\n  );\n  let metaArrowStart: number | undefined;\n  let metaArrowTarget: number | undefined;\n  const currentMetaPhrase =\n    currentPhrase !== undefined && currentPhrase > firstPassPhrases.length\n      ? Math.min(\n          currentPhrase - firstPassPhrases.length - 1,\n          metaSymbolPhrases.length - 1\n        )\n      : undefined;\n  if (\n    currentPhrase !== undefined &&\n    currentMetaPhrase !== undefined &&\n    currentPhrase < firstPassPhrases.length + metaSymbolPhrases.length + 1\n  ) {\n    const phrase = metaSymbolPhrases[currentMetaPhrase];\n    if (phrase.type === \"copy\") {\n      for (let i = 0; i < phrase.l; i++) {\n        metaColors[phrase.p + i] = \"source\";\n      }\n      metaArrowTarget = phrase.p;\n    }\n    const phrasePos = sum(\n      take(metaSymbolPhrases, currentMetaPhrase).map((p) => p.l)\n    );\n    metaArrowStart = phrasePos;\n    for (let i = 0; i < phrase.l; i++) {\n      metaColors[phrasePos + i] =\n        metaColors[phrasePos + i] === \"none\" ? \"target\" : \"source-target\";\n    }\n  }\n\n  if (currentMetaPhrase !== undefined) {\n    let currentPos = 0;\n    take(metaSymbolPhrases, currentMetaPhrase + 1).forEach((p, i) => {\n      if (p.type === \"literal\") {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 300,\n          text: `(${metaSymbols[i]},0)`,\n        });\n      } else if (p.l === 1) {\n        shortPhrases.push({\n          x: currentPos * 30,\n          y: 300,\n          text: `(${p.p},${p.l})`,\n        });\n      } else {\n        copyingPhrases.push({\n          x1: currentPos * 30 + 22,\n          x2: currentPos * 30 + p.l * 30 + 18,\n          y: 300,\n          ...p,\n        });\n      }\n      currentPos += p.l;\n    });\n  }\n\n  const backMappingArrows: [number, number][] = [];\n  if (currentPhrase !== undefined && currentPhrase === data.stepsCount) {\n    let currentPos = 0;\n    let currentMetaPos = 0;\n    zip(phrases, metaSymbolPhrases).forEach(([p, metaP], i) => {\n      if (p && metaP) {\n        if (p.type === \"literal\") {\n          shortPhrases.push({\n            x: currentPos * 30,\n            y: 145,\n            text: `(${String.fromCodePoint(p.symbol)},0)`,\n          });\n        } else if (p.l === 1) {\n          shortPhrases.push({\n            x: currentPos * 30,\n            y: 145,\n            text: `(${p.p},${p.l})`,\n          });\n        } else {\n          copyingPhrases.push({\n            x1: currentPos * 30 + 22,\n            x2: currentPos * 30 + p.l * 30 + 18,\n            y: 145,\n            ...p,\n          });\n        }\n\n        backMappingArrows.push([\n          currentMetaPos * 30 + 35 + (metaP.l - 1) * 15,\n          currentPos * 30 + 35 + +(p.l - 1) * 15,\n        ]);\n\n        currentPos += p.l;\n        currentMetaPos += metaP?.l;\n      }\n    });\n  }\n\n  return (\n    <svg height=\"500\" width=\"100%\">\n      <SharedDefinitions></SharedDefinitions>\n\n      {input.split(\"\").map((char, i) => (\n        <Character\n          key={i}\n          x={i * 30 + 20}\n          y={50}\n          text={char}\n          color={colors[i]}\n        ></Character>\n      ))}\n\n      {arrowStart !== undefined && arrowTarget !== undefined && (\n        <Arrow\n          x1={arrowStart * 30 + 35}\n          x2={arrowTarget * 30 + 35}\n          y={50}\n        ></Arrow>\n      )}\n\n      {shortPhrases.map((props, i) => (\n        <ShortPhrase key={i} {...props}></ShortPhrase>\n      ))}\n\n      {copyingPhrases.map((props, i) => (\n        <CopyingPhrase key={i} {...props}></CopyingPhrase>\n      ))}\n\n      {mappingArrows.map(([x1, x2], i) => (\n        <Arrow2 key={i} x1={x1} y1={130} x2={x2} y2={259} straight></Arrow2>\n      ))}\n\n      {metaSymbols.map((char, i) => (\n        <Character\n          key={i}\n          x={i * 30 + 20}\n          y={260}\n          text={char}\n          color={metaColors[i]}\n        ></Character>\n      ))}\n\n      {metaArrowStart !== undefined && metaArrowTarget !== undefined && (\n        <Arrow\n          x1={metaArrowStart * 30 + 35}\n          x2={metaArrowTarget * 30 + 35}\n          y={260}\n        ></Arrow>\n      )}\n\n      {finalStep && (\n        <line\n          x1=\"20\"\n          y1=\"132\"\n          x2={input.length * 30 + 20}\n          y2=\"132\"\n          stroke=\"black\"\n        />\n      )}\n      {finalStep && (\n        <line\n          x1=\"20\"\n          y1=\"135\"\n          x2={input.length * 30 + 20}\n          y2=\"135\"\n          stroke=\"black\"\n        />\n      )}\n\n      {backMappingArrows.map(([x1, x2]) => (\n        <Arrow2 x1={x1} y1={260} x2={x2} y2={220} straight></Arrow2>\n      ))}\n    </svg>\n  );\n}\n","import { drop, last, sum, take } from \"lodash\";\nimport React from \"react\";\nimport { Phrase } from \"../algorithms/compression\";\nimport {\n  Lz77VisualizationData,\n  RelzRecVisualizationData,\n  RelzVisualizationData,\n} from \"./common\";\nimport {\n  Arrow,\n  Arrow2,\n  ArrowProps2,\n  Character,\n  CharacterColor,\n  CopyingPhrase,\n  CopyingPhraseProps,\n  PhraseDisplay,\n  PhraseDisplayProps,\n  SharedDefinitions,\n  ShortPhrase,\n  ShortPhraseProps,\n} from \"./drawing\";\n\nexport interface RelzRecVisualizationProps {\n  data: RelzRecVisualizationData;\n  currentPhrase?: number;\n}\n\nexport function RelzRecVisualization(props: RelzRecVisualizationProps) {\n  const { data, currentPhrase } = props;\n  const { input, phrases, passes, prefixLength } = data;\n  const lineDistance = 120;\n  const step = data.steps[currentPhrase ?? 0];\n  console.log(step);\n\n  const passOffsets = passes.reduce(\n    (lengths: number[], pass) => {\n      const length =\n        (last(lengths) ?? 0) + sum(pass.prefixPhrases.map((p) => p.l));\n      return [...lengths, length];\n    },\n    [0]\n  );\n\n  const [passesVisible, phrasesVisible, mappingsVisible, backMappingsVisible] =\n    step.type === \"initial\"\n      ? [1, 0, 0, 0]\n      : step.type === \"compress\"\n      ? [step.pass + 1, step.phrase + 1, step.pass]\n      : step.type === \"mapping\"\n      ? [step.pass + 2, 0, step.pass + 1]\n      : [passes.length, prefixLength, 0];\n  const symbols = take(passes, passesVisible).map(({ input }, i) => ({\n    x: passOffsets[i] * 30 + 30,\n    y: i * lineDistance + 30,\n    symbols:\n      i === 0\n        ? input.map((c) => String.fromCodePoint(c))\n        : input.map((c) => String(c)),\n  }));\n  const phraseDisplays: PhraseDisplayProps[] = [];\n  const mappingArrows: ArrowProps2[] = [];\n\n  take(passes, passesVisible).forEach((pass, i) => {\n    take(\n      pass.prefixPhrases,\n      i === passesVisible - 1 ? phrasesVisible : pass.prefixPhrases.length\n    ).forEach((p) => {\n      const { pos } = p;\n      if (p.type === \"literal\") {\n        const text = `(${\n          i === 0 ? String.fromCodePoint(p.symbol) : String(p.symbol)\n        },0)`;\n        phraseDisplays.push({\n          x: pos * 30 + passOffsets[i] * 30 + 30,\n          y: 65 + lineDistance * i,\n          l: 1,\n          text,\n        });\n      } else {\n        const text = `(${p.p},${p.l})`;\n        phraseDisplays.push({\n          x: pos * 30 + passOffsets[i] * 30 + 30,\n          y: 65 + lineDistance * i,\n          l: p.l,\n          text,\n        });\n      }\n    });\n    take(\n      pass.suffixPhrases,\n      i === passesVisible - 1\n        ? phrasesVisible - prefixLength\n        : pass.suffixPhrases.length\n    ).forEach((p) => {\n      const pos = p.pos;\n      console.log(p);\n      if (p.type === \"literal\") {\n        const text = `(${\n          i === 0 ? String.fromCodePoint(p.symbol) : String(p.symbol)\n        },0)`;\n        phraseDisplays.push({\n          x: pos * 30 + passOffsets[i] * 30 + 30,\n          y: 65 + lineDistance * i,\n          l: 1,\n          text,\n        });\n      } else {\n        const text = `(${p.p},${p.l})`;\n        phraseDisplays.push({\n          x: pos * 30 + passOffsets[i] * 30 + 30,\n          y: 65 + lineDistance * i,\n          l: p.l,\n          text,\n        });\n      }\n    });\n  });\n\n  take(passes, mappingsVisible).forEach((pass, i) =>\n    pass.suffixPhrases.forEach((p, pi) => {\n      mappingArrows.push({\n        x1: p.pos * 30 + 30 + p.l * 15 + passOffsets[i] * 30,\n        y1: 100 + i * lineDistance,\n        x2: pi * 30 + passOffsets[i + 1] * 30 + 45,\n        y2: 150 + i * lineDistance,\n        straight: true,\n      });\n    })\n  );\n\n  return (\n    <>\n      <div>{JSON.stringify(step)}</div>\n      <svg height={passes.length * lineDistance} width=\"100%\">\n        <SharedDefinitions></SharedDefinitions>\n\n        {symbols.map(({ x, y, symbols }, i) =>\n          symbols.map((c, h) => (\n            <Character\n              key={`${i}+${h}`}\n              x={x + h * 30}\n              y={y}\n              text={c}\n            ></Character>\n          ))\n        )}\n\n        {phraseDisplays.map((props, i) => (\n          <PhraseDisplay key={i} {...props}></PhraseDisplay>\n        ))}\n\n        {mappingArrows.map((props, i) => (\n          <Arrow2 key={i} {...props}></Arrow2>\n        ))}\n\n        <Arrow x1={50} x2={300} y={30}></Arrow>\n      </svg>\n    </>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport {\n  compressLz77,\n  compressWithSlidingWindow,\n  Phrase,\n  RlzPhrase,\n} from \"./algorithms/compression\";\nimport { stringToCodePoints } from \"./algorithms/utils\";\nimport Button from \"react-bootstrap/Button\";\nimport Card from \"react-bootstrap/Card\";\nimport Form from \"react-bootstrap/Form\";\nimport { availableCompressors, CompressorType } from \"./compressors\";\nimport { keys, mapValues, sum, take, values } from \"lodash\";\nimport { string } from \"fast-check\";\nimport { Lz77Visualization } from \"./visualizations/Lz77Visualization\";\nimport { computeData } from \"./visualizations/common\";\nimport { RlzVisualization } from \"./visualizations/RlzVisualization\";\nimport { RelzVisualization } from \"./visualizations/RelzVisualization\";\nimport InputGroup from \"react-bootstrap/esm/InputGroup\";\nimport FormControl from \"react-bootstrap/esm/FormControl\";\nimport { useQuery } from \"./hooks\";\nimport { useLocation } from \"react-router-dom\";\nimport { RelzRecVisualization } from \"./visualizations/RelzRecVisualization\";\n\nexport default function Slides() {\n  const [input, setInput] = useState(\"ABCCDBCCABDD\");\n\n  const [visible, setVisible] = useState(false);\n  const [currentStep, setCurrentStep] = useState<number>(0);\n\n  const [selectedCompressor, setSelectedCompressor] = useState<CompressorType>(\n    \"lz77\"\n  );\n  const currentCompressor = availableCompressors[selectedCompressor];\n  const [referenceString, setReferenceString] = useState(\"\");\n  const [windowSize, setWindowSize] = useState(5);\n  const [prefixSize, setPrefixSize] = useState(5);\n  const [recursionLimit, setRecursionLimit] = useState(5);\n\n  const query = useQuery();\n  useEffect(() => {\n    const type = query.get(\"type\");\n    const windowSize = query.get(\"window\");\n    const prefix = query.get(\"prefix\");\n    const recursion = query.get(\"recursion\");\n    const reference = query.get(\"reference\");\n    if (type !== null && keys(availableCompressors).includes(type)) {\n      setSelectedCompressor(type as CompressorType);\n    }\n  }, []);\n\n  const data = computeData(selectedCompressor, input, {\n    reference: referenceString,\n    windowSize,\n    prefixSize,\n    recursionLimit,\n  });\n  useEffect(() => {\n    if (currentStep !== undefined && data !== undefined) {\n      setCurrentStep(Math.min(data?.stepsCount, currentStep));\n    }\n  }, [data, data?.stepsCount, currentStep]);\n\n  const { pathname } = useLocation();\n\n  const currentQuery = new URLSearchParams();\n  currentQuery.set(\"type\", selectedCompressor);\n  if (availableCompressors[selectedCompressor].needsPrefixSize) {\n    currentQuery.set(\"prefix\", String(prefixSize));\n  }\n  if (availableCompressors[selectedCompressor].needsWindowSize) {\n    currentQuery.set(\"window\", String(windowSize));\n  }\n  if (availableCompressors[selectedCompressor].needsRecursionLimit) {\n    currentQuery.set(\"recursion\", String(recursionLimit));\n  }\n  if (availableCompressors[selectedCompressor].needsReference) {\n    currentQuery.set(\"reference\", referenceString);\n  }\n  currentQuery.set(\"step\", String(currentStep || 0));\n\n  const url = `${\n    window.location.origin\n  }/#${pathname}?${currentQuery.toString()}`;\n\n  return (\n    <>\n      <Row className=\"mt-5\">\n        <Col>\n          <Card>\n            <Card.Header>Settings</Card.Header>\n            <Card.Body>\n              <Form>\n                <Form.Group>\n                  <Form.Label>Input String</Form.Label>\n                  <Form.Control\n                    value={input}\n                    onChange={(e) => setInput(e.target.value)}\n                  />\n                </Form.Group>\n                <Form.Row>\n                  <Col>\n                    <Form.Group>\n                      <Form.Label>Compression Algorithm</Form.Label>\n                      {values(availableCompressors).map((c) => (\n                        <Form.Check\n                          key={c.type}\n                          label={c.title}\n                          name=\"compressor-group\"\n                          type=\"radio\"\n                          checked={selectedCompressor === c.type}\n                          onChange={() => setSelectedCompressor(c.type)}\n                        />\n                      ))}\n                    </Form.Group>\n                  </Col>\n                  <Col>\n                    {currentCompressor.needsReference && (\n                      <Form.Group key=\"reference-string\">\n                        <Form.Label>Reference</Form.Label>\n                        <Form.Control\n                          placeholder=\"Reference String\"\n                          value={referenceString}\n                          onChange={(e) => setReferenceString(e.target.value)}\n                        />\n                      </Form.Group>\n                    )}\n                    {currentCompressor.needsPrefixSize && (\n                      <Form.Group>\n                        <Form.Label>Prefix Size</Form.Label>\n                        <Form.Control\n                          type=\"number\"\n                          value={prefixSize}\n                          onChange={(e) =>\n                            setPrefixSize(parseInt(e.target.value))\n                          }\n                        />\n                      </Form.Group>\n                    )}\n                    {currentCompressor.needsWindowSize && (\n                      <Form.Group>\n                        <Form.Label>Window Size</Form.Label>\n                        <Form.Control\n                          type=\"number\"\n                          value={windowSize}\n                          onChange={(e) =>\n                            setWindowSize(parseInt(e.target.value))\n                          }\n                        />\n                      </Form.Group>\n                    )}\n                    {currentCompressor.needsRecursionLimit && (\n                      <Form.Group>\n                        <Form.Label>Recursion Limit</Form.Label>\n                        <Form.Control\n                          type=\"number\"\n                          value={recursionLimit}\n                          onChange={(e) =>\n                            setRecursionLimit(parseInt(e.target.value))\n                          }\n                        />\n                      </Form.Group>\n                    )}\n                  </Col>\n                </Form.Row>\n              </Form>\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n      <Row className=\"mt-5\">\n        <Col>\n          <Card>\n            <Card.Body>\n              {data?.type === \"lz77\" && (\n                <Lz77Visualization\n                  data={data}\n                  currentPhrase={currentStep}\n                ></Lz77Visualization>\n              )}\n              {data?.type === \"rlz\" && (\n                <RlzVisualization\n                  data={data}\n                  currentPhrase={currentStep}\n                ></RlzVisualization>\n              )}\n              {data?.type === \"relz\" && (\n                <RelzVisualization\n                  data={data}\n                  currentPhrase={currentStep}\n                ></RelzVisualization>\n              )}\n              {data?.type === \"relz-rec\" && (\n                <RelzRecVisualization\n                  data={data}\n                  currentPhrase={currentStep}\n                ></RelzRecVisualization>\n              )}\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n      <Row>\n        <Col md=\"1\">\n          <Button\n            disabled={currentStep === 0}\n            onClick={() => setCurrentStep(Math.max(0, currentStep - 1))}\n          >\n            Previous\n          </Button>\n        </Col>\n        <Col md=\"1\">\n          <Button\n            disabled={currentStep === data?.stepsCount}\n            onClick={() =>\n              setCurrentStep(\n                Math.min((data?.stepsCount || currentStep+1)-1, currentStep + 1)\n              )\n            }\n          >\n            Next\n          </Button>\n        </Col>\n        <Col>\n          Step {currentStep+1} / {data?.stepsCount}\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Card>\n            <Card.Body>\n              <InputGroup className=\"mb-3\">\n                <FormControl value={url} readOnly />\n                <InputGroup.Append>\n                  <Button variant=\"outline-secondary\">Copy</Button>\n                </InputGroup.Append>\n              </InputGroup>\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n    </>\n  );\n}\n","import { useLocation } from \"react-router-dom\";\n\nexport function useQuery() {\n  const location = useLocation();\n  return new URLSearchParams(location.search);\n}\n","import { drop, range, reverse, sum, sumBy } from \"lodash\";\nimport {\n  compressLz77,\n  compressRelz,\n  compressRelzRecursive,\n  compressRlz,\n  compressRlzPrefix,\n  Phrase,\n  RelzRecPass,\n  RlzPhrase,\n} from \"../algorithms/compression\";\nimport { stringToCodePoints } from \"../algorithms/utils\";\nimport { CompressorType } from \"../compressors\";\n\nexport interface Lz77VisualizationData {\n  type: \"lz77\";\n  input: string;\n  phrases: Phrase[];\n  stepsCount: number;\n}\n\nexport interface RlzVisualizationData {\n  type: \"rlz\";\n  input: string;\n  reference: string;\n  phrases: RlzPhrase[];\n  stepsCount: number;\n}\n\nexport interface RlzPrefixVisualizationData {\n  type: \"rlz-pref\";\n  input: string;\n  phrases: Phrase[];\n  stepsCount: number;\n}\n\nexport interface RelzVisualizationData {\n  type: \"relz\";\n  input: string;\n  prefixLength: number;\n  firstPassPhrases: Phrase[];\n  metaSymbols: number[];\n  metaSymbolPhrases: Phrase[];\n  phrases: Phrase[];\n  stepsCount: number;\n}\n\ntype RelzRecStep =\n  | { type: \"initial\" }\n  | { type: \"compress\"; pass: number; phrase: number }\n  | { type: \"mapping\"; pass: number }\n  | { type: \"back-mapping\"; pass: number; phrase: number };\n\nexport interface RelzRecVisualizationData {\n  type: \"relz-rec\";\n  input: string;\n  prefixLength: number;\n  passes: RelzRecPass[];\n  phrases: Phrase[];\n  stepsCount: number;\n  steps: RelzRecStep[];\n}\n\nexport type VisualizationData =\n  | Lz77VisualizationData\n  | RlzVisualizationData\n  | RlzPrefixVisualizationData\n  | RelzVisualizationData\n  | RelzRecVisualizationData;\n\ninterface Settings {\n  windowSize: number;\n  prefixSize: number;\n  reference: string;\n  recursionLimit: number;\n}\n\nexport function computeData(\n  type: CompressorType,\n  input: string,\n  settings: Settings\n): VisualizationData | undefined {\n  const codePoints = stringToCodePoints(input);\n  if (type === \"lz77\") {\n    const phrases = [...compressLz77(codePoints)];\n    return { type: \"lz77\", input, phrases, stepsCount: phrases.length };\n  } else if (type === \"rlz\") {\n    const { reference } = settings;\n    const referenceCodePoints = stringToCodePoints(reference);\n    const phrases = [...compressRlz(codePoints, referenceCodePoints)];\n    return {\n      type: \"rlz\",\n      input,\n      reference,\n      phrases,\n      stepsCount: phrases.length,\n    };\n  } else if (type === \"rlz-pref\") {\n    const [prefixPhrases, suffixPhrases] = [\n      ...compressRlzPrefix(codePoints, settings.prefixSize),\n    ];\n    const phrases = [...prefixPhrases, ...suffixPhrases];\n    return { type: \"lz77\", input, phrases, stepsCount: phrases.length }; // FIXME\n  } else if (type === \"relz\") {\n    const result = compressRelz(codePoints, settings.prefixSize);\n    return {\n      type: \"relz\",\n      input,\n      prefixLength: settings.prefixSize,\n      ...result,\n      stepsCount:\n        result.firstPassPhrases.length + result.metaSymbolPhrases.length + 2,\n    };\n  } else if (type === \"relz-rec\") {\n    const result = compressRelzRecursive(\n      codePoints,\n      settings.prefixSize,\n      settings.recursionLimit\n    );\n    const lastPass = result.passes.length - 1;\n    const steps: RelzRecStep[] = [\n      { type: \"initial\" },\n      ...result.passes.flatMap((pass, i) => [\n        ...pass.prefixPhrases.map((p, h) => ({\n          type: \"compress\" as const,\n          pass: i,\n          phrase: h,\n        })),\n        ...pass.suffixPhrases.map((p, h) => ({\n          type: \"compress\" as const,\n          pass: i,\n          phrase: h + pass.prefixPhrases.length,\n        })),\n        ...(i === lastPass ? [] : [{ type: \"mapping\" as const, pass: i }]),\n      ]),\n      ...reverse([...result.passes]).flatMap((pass, i) =>\n        pass.suffixPhrasesCompressed.map((p, h) => ({\n          type: \"back-mapping\" as const,\n          pass: result.passes.length - i - 1,\n          phrase: h,\n        }))\n      ),\n    ];\n    const stepsCount = steps.length;\n    return {\n      type: \"relz-rec\",\n      input,\n      prefixLength: settings.prefixSize,\n      passes: result.passes,\n      phrases: result.phrases,\n      stepsCount,\n      steps,\n    };\n  }\n}\n","import React, { useState } from \"react\";\nimport Container from \"react-bootstrap/Container\";\nimport { Link, Route, Switch } from \"react-router-dom\";\nimport { Compare } from \"./Compare\";\nimport Slides from \"./Slides\";\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Nav from \"react-bootstrap/Nav\";\n\nfunction App() {\n  return (\n    <>\n      <Navbar bg=\"dark\" variant=\"dark\">\n        <Container>\n          <Navbar.Brand href=\"#home\">Lempel-Ziv Playground</Navbar.Brand>\n          <Nav className=\"mr-auto\">\n            <Nav.Link to=\"/slides\" as={Link}>Slides</Nav.Link>\n            <Nav.Link to=\"/compare\" as={Link}>Compare</Nav.Link>\n            <Nav.Link href=\"#pricing\">Pricing</Nav.Link>\n          </Nav>\n          {/* <Form inline>\n          <FormControl type=\"text\" placeholder=\"Search\" className=\"mr-sm-2\" />\n          <Button variant=\"outline-info\">Search</Button>\n        </Form> */}\n        </Container>\n      </Navbar>\n      <Container>\n        <Switch>\n          <Route exact path=\"/compare\">\n            <Compare></Compare>\n          </Route>\n          <Route exact path=\"/slides\">\n            <Slides></Slides>\n          </Route>\n        </Switch>\n      </Container>\n    </>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import \"bootstrap/dist/css/bootstrap.min.css\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { HashRouter } from \"react-router-dom\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter>\n      <App />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}